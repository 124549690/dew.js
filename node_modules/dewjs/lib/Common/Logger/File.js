/**
 * @author     LiuZhaoHui <hi.liuzhaoxin@gmail.com>
 * @link       http://www.eatbean.com/nodejs
**/

"use strict";

module.exports = File;

var fs = require("fs");

var string = Dew("use", "Common.String");
var date = Dew("use", "Common.Date");

function File (options, logPath)
{
    this._logPath = logPath;
}

File.prototype = 
{
    constructor : File, 
    
    _writerErrorFormat : "[%s] %s - %s\n", 
    _fileNameFormat : "Y-m-d", 
    
    append : function (time, type, message)
    {
        var file = this._logPath + "/" + date.format(this._fileNameFormat) + ".log";
        var text = string.format(this._writerErrorFormat, time, type, message);
        
        fs.open(file, "a+", "0777", function (err, fp) {
            fs.write(fp, text, null, null, function () {
                fs.close(fp);
            });
        });
    }
};